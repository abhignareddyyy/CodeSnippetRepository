{% extends "base.html" %}

{% block head_extra %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;700&display=swap" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Full-Screen Container -->
<div class="fixed inset-0 bg-gradient-to-br from-gray-50 via-indigo-50/20 to-gray-100 dark:from-gray-900 dark:via-indigo-950 dark:to-gray-800 flex flex-col overflow-y-auto font-['Manrope',_sans-serif] antialiased">
    <div class="w-full p-6 py-16 flex-grow flex flex-col items-center relative isolate">
        <!-- Subtle Background Texture -->
        <div class="absolute inset-0 -z-10 bg-[radial-gradient(ellipse_at_center,_rgba(79,70,229,0.15)_0%,_rgba(0,0,0,0)_70%)] dark:bg-[radial-gradient(ellipse_at_center,_rgba(99,102,241,0.1)_0%,_rgba(0,0,0,0)_70%)] opacity-80" aria-hidden="true"></div>

        <!-- Settings Header -->
        <div class="mb-12 text-center">
            <h1 class="text-5xl sm:text-6xl font-bold text-gray-900 dark:text-white bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600 dark:from-indigo-400 dark:to-purple-400 tracking-tight">
                Edit Your Profile
            </h1>
            <p class="mt-4 text-lg sm:text-xl text-gray-600 dark:text-gray-300 font-light max-w-2xl mx-auto leading-relaxed">
                Update your personal and professional details to keep your profile fresh.
            </p>
        </div>

        <!-- Settings Form Card -->
        <div class="w-full max-w-5xl bg-gradient-to-br from-white to-indigo-50/30 dark:from-gray-900 dark:to-indigo-950/40 rounded-3xl shadow-2xl dark:shadow-[0_15px_60px_rgba(99,102,241,0.15)] border border-gray-200/20 dark:border-indigo-900/30 backdrop-blur-md p-10 sm:p-14">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="mb-8 space-y-4">
                        {% for category, message in messages %}
                            <div class="p-4 rounded-xl text-center text-base font-medium {% if category == 'error' %}bg-red-500/10 text-red-600 dark:text-red-400 border border-red-500/20{% else %}bg-green-500/10 text-green-600 dark:text-green-400 border border-green-500/20{% endif %} shadow-sm">
                                {{ message }}
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            <form action="{{ url_for('settings') }}" method="POST" class="space-y-12">
                <!-- Personal Info Section -->
                <fieldset>
                    <legend class="text-sm font-semibold tracking-widest uppercase text-indigo-600 dark:text-indigo-400 mb-6 pb-2 border-b border-gray-200/30 dark:border-indigo-900/40">Personal Information</legend>
                    <div class="space-y-8">
                        <div>
                            <label for="bio" class="block text-base font-medium text-gray-800 dark:text-gray-200">
                                Bio
                            </label>
                            <textarea id="bio"
                                      name="bio"
                                      rows="4"
                                      class="mt-3 block w-full bg-white/80 dark:bg-gray-900/80 border border-gray-200/50 dark:border-indigo-900/50 rounded-xl px-5 py-4 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-400/50 focus:border-indigo-400 shadow-md hover:shadow-lg transition-all duration-300 ease-out text-base"
                                      placeholder="Tell us about yourselfâ€”your passions, skills, or aspirations...">{{ user.bio if user and user.bio else '' }}</textarea>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-8">
                            <div>
                                <label for="full_name" class="block text-base font-medium text-gray-800 dark:text-gray-200 mb-2">
                                    <span class="flex items-center">
                                        <svg class="w-5 h-5 mr-2 text-indigo-500 dark:text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"></path></svg>
                                        Full Name
                                    </span>
                                </label>
                                <input type="text"
                                       id="full_name"
                                       name="full_name"
                                       value="{{ user.full_name if user and user.full_name else '' }}"
                                       class="block w-full bg-white/80 dark:bg-gray-900/80 border border-gray-200/50 dark:border-indigo-900/50 rounded-xl px-5 py-4 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-400/50 focus:border-indigo-400 shadow-md hover:shadow-lg transition-all duration-300 ease-out text-base"
                                       placeholder="e.g., Arjun Sharma">
                            </div>
                            <div>
                                <label for="dob" class="block text-base font-medium text-gray-800 dark:text-gray-200 mb-2">
                                    <span class="flex items-center">
                                        <svg class="w-5 h-5 mr-2 text-indigo-500 dark:text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5m-9-6h.008v.008H12v-.008zM12 15h.008v.008H12V15zm0 2.25h.008v.008H12v-.008zM9.75 15h.008v.008H9.75V15zm0 2.25h.008v.008H9.75v-.008zM7.5 15h.008v.008H7.5V15zm0 2.25h.008v.008H7.5v-.008zm6.75-4.5h.008v.008h-.008v-.008zm0 2.25h.008v.008h-.008V15zm0 2.25h.008v.008h-.008v-.008zm2.25-4.5h.008v.008H16.5v-.008zm0 2.25h.008v.008H16.5V15z"></path></svg>
                                        Date of Birth
                                    </span>
                                </label>
                                <input type="date"
                                       id="dob"
                                       name="dob"
                                       value="{{ user.dob if user and user.dob else '' }}"
                                       class="block w-full bg-white/80 dark:bg-gray-900/80 border border-gray-200/50 dark:border-indigo-900/50 rounded-xl px-5 py-4 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-400/50 focus:border-indigo-400 shadow-md hover:shadow-lg transition-all duration-300 ease-out text-base appearance-none">
                            </div>
                            <div>
                                <label for="age" class="block text-base font-medium text-gray-800 dark:text-gray-200 mb-2">
                                    Age
                                </label>
                                <input type="number"
                                       id="age"
                                       name="age"
                                       min="1"
                                       max="150"
                                       value="{{ user.age if user and user.age else '' }}"
                                       class="block w-full bg-white/80 dark:bg-gray-900/80 border border-gray-200/50 dark:border-indigo-900/50 rounded-xl px-5 py-4 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-400/50 focus:border-indigo-400 shadow-md hover:shadow-lg transition-all duration-300 ease-out text-base"
                                       placeholder="Your age">
                            </div>
                        </div>
                    </div>
                </fieldset>

                <!-- Professional Info Section -->
                <fieldset>
                    <legend class="text-sm font-semibold tracking-widest uppercase text-indigo-600 dark:text-indigo-400 mb-6 pb-2 border-b border-gray-200/30 dark:border-indigo-900/40">Professional Details</legend>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-8">
                        <div>
                            <label for="status" class="block text-base font-medium text-gray-800 dark:text-gray-200 mb-2">
                                Current Status
                            </label>
                            <select id="status"
                                    name="status"
                                    class="block w-full bg-white/80 dark:bg-gray-900/80 border border-gray-200/50 dark:border-indigo-900/50 rounded-xl px-5 py-4 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-400/50 focus:border-indigo-400 shadow-md hover:shadow-lg transition-all duration-300 ease-out text-base appearance-none">
                                <option value="" {% if not user or not user.status %}selected{% endif %}>Select your status</option>
                                <option value="student" {% if user and user.status == 'student' %}selected{% endif %}>Student</option>
                                <option value="working_professional" {% if user and user.status == 'working_professional' %}selected{% endif %}>Working Professional</option>
                                <option value="freelancer" {% if user and user.status == 'freelancer' %}selected{% endif %}>Freelancer</option>
                                <option value="other" {% if user and user.status == 'other' %}selected{% endif %}>Other</option>
                            </select>
                        </div>
                        <div>
                            <label for="profession" class="block text-base font-medium text-gray-800 dark:text-gray-200 mb-2">
                                Profession
                            </label>
                            <select id="profession"
                                    name="profession"
                                    class="block w-full bg-white/80 dark:bg-gray-900/80 border border-gray-200/50 dark:border-indigo-900/50 rounded-xl px-5 py-4 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-400/50 focus:border-indigo-400 shadow-md hover:shadow-lg transition-all duration-300 ease-out text-base appearance-none">
                                <option value="" {% if not user or not user.profession %}selected{% endif %}>Select your profession</option>
                                <option value="software_developer" {% if user and user.profession == 'software_developer' %}selected{% endif %}>Software Developer</option>
                                <option value="data_scientist" {% if user and user.profession == 'data_scientist' %}selected{% endif %}>Data Scientist</option>
                                <option value="web_designer" {% if user and user.profession == 'web_designer' %}selected{% endif %}>Web Designer</option>
                                <option value="student" {% if user and user.profession == 'student' %}selected{% endif %}>Student</option>
                                <option value="teacher" {% if user and user.profession == 'teacher' %}selected{% endif %}>Teacher</option>
                                <option value="engineer" {% if user and user.profession == 'engineer' %}selected{% endif %}>Engineer</option>
                                <option value="marketing_specialist" {% if user and user.profession == 'marketing_specialist' %}selected{% endif %}>Marketing Specialist</option>
                                <option value="other" {% if user and user.profession == 'other' %}selected{% endif %}>Other</option>
                            </select>
                        </div>
                        <div>
                            <label for="experience" class="block text-base font-medium text-gray-800 dark:text-gray-200 mb-2">
                                Years of Experience
                            </label>
                            <input type="number"
                                   id="experience"
                                   name="experience"
                                   value="{{ user.experience if user and user.experience is not none else '' }}"
                                   min="0"
                                   max="50"
                                   class="block w-full bg-white/80 dark:bg-gray-900/80 border border-gray-200/50 dark:border-indigo-900/50 rounded-xl px-5 py-4 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-400/50 focus:border-indigo-400 shadow-md hover:shadow-lg transition-all duration-300 ease-out text-base"
                                   placeholder="e.g., 3">
                        </div>
                        <div>
                            <label for="education" class="block text-base font-medium text-gray-800 dark:text-gray-200 mb-2">
                                Highest Education
                            </label>
                            <select id="education"
                                    name="education"
                                    class="block w-full bg-white/80 dark:bg-gray-900/80 border border-gray-200/50 dark:border-indigo-900/50 rounded-xl px-5 py-4 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-400/50 focus:border-indigo-400 shadow-md hover:shadow-lg transition-all duration-300 ease-out text-base appearance-none">
                                <option value="" {% if not user or not user.education %}selected{% endif %}>Select your education</option>
                                <option value="high_school" {% if user and user.education == 'high_school' %}selected{% endif %}>High School Diploma</option>
                                <option value="associate" {% if user and user.education == 'associate' %}selected{% endif %}>Associate Degree</option>
                                <option value="bachelor" {% if user and user.education == 'bachelor' %}selected{% endif %}>Bachelorâ€™s Degree</option>
                                <option value="master" {% if user and user.education == 'master' %}selected{% endif %}>Masterâ€™s Degree</option>
                                <option value="phd" {% if user and user.education == 'phd' %}selected{% endif %}>Ph.D.</option>
                                <option value="certificate" {% if user and user.education == 'certificate' %}selected{% endif %}>Professional Certificate</option>
                                <option value="none" {% if user and user.education == 'none' %}selected{% endif %}>None</option>
                            </select>
                        </div>
                    </div>
                </fieldset>

                <!-- Skills Section -->
                <fieldset>
                    <legend class="text-sm font-semibold tracking-widest uppercase text-indigo-600 dark:text-indigo-400 mb-6 pb-2 border-b border-gray-200/30 dark:border-indigo-900/40">Skills</legend>
                    <p class="text-sm text-gray-600 dark:text-gray-300 font-light mb-6 -mt-4">Highlight your expertise. Select all that apply.</p>
                    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-x-6 gap-y-4">
                        {% set user_skills = user.skills if user and user.skills else [] %}
                        {% set all_skills = {
                            'python': 'Python', 'javascript': 'JavaScript', 'java': 'Java', 'cpp': 'C++',
                            'html_css': 'HTML/CSS', 'react': 'React', 'node': 'Node.js', 'sql': 'SQL',
                            'machine_learning': 'Machine Learning', 'web_design': 'Web Design',
                            'project_management': 'Project Management', 'communication': 'Communication'
                        } %}
                        {% for value, label in all_skills.items() %}
                        <div class="relative flex items-start">
                            <div class="flex h-6 items-center">
                                <input id="skill_{{ value }}"
                                       name="skills"
                                       type="checkbox"
                                       value="{{ value }}"
                                       class="h-5 w-5 rounded border-gray-300 dark:border-indigo-900/60 text-indigo-600 dark:text-indigo-400 focus:ring-indigo-400/50 shadow-sm transition-all duration-200"
                                       {% if value in user_skills %}checked{% endif %}>
                            </div>
                            <div class="ml-3 text-base leading-6">
                                <label for="skill_{{ value }}" class="font-medium text-gray-800 dark:text-gray-200 cursor-pointer hover:text-indigo-600 dark:hover:text-indigo-300 transition-colors duration-200">
                                    {{ label }}
                                </label>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </fieldset>

                <!-- Additional Info Section -->
                <fieldset>
                    <legend class="text-sm font-semibold tracking-widest uppercase text-indigo-600 dark:text-indigo-400 mb-6 pb-2 border-b border-gray-200/30 dark:border-indigo-900/40">Additional Information</legend>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-8">
                        <div>
                            <label for="country" class="block text-base font-medium text-gray-800 dark:text-gray-200 mb-2">
                                <span class="flex items-center">
                                    <svg class="w-5 h-5 mr-2 text-indigo-500 dark:text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"></path></svg>
                                    Country
                                </span>
                            </label>
                            <select id="country"
                                    name="country"
                                    class="block w-full bg-white/80 dark:bg-gray-900/80 border border-gray-200/50 dark:border-indigo-900/50 rounded-xl px-5 py-4 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-400/50 focus:border-indigo-400 shadow-md hover:shadow-lg transition-all duration-300 ease-out text-base appearance-none">
                                <option value="" {% if not user or not user.country %}selected{% endif %}>Select your country</option>
                                <option value="india" {% if user and user.country == 'india' %}selected{% endif %}>India</option>
                                <option value="united_states" {% if user and user.country == 'united_states' %}selected{% endif %}>United States</option>
                                <option value="united_kingdom" {% if user and user.country == 'united_kingdom' %}selected{% endif %}>United Kingdom</option>
                                <option value="canada" {% if user and user.country == 'canada' %}selected{% endif %}>Canada</option>
                                <option value="australia" {% if user and user.country == 'australia' %}selected{% endif %}>Australia</option>
                            </select>
                        </div>
                        <div>
                            <label for="website" class="block text-base font-medium text-gray-800 dark:text-gray-200 mb-2">
                                <span class="flex items-center">
                                    <svg class="w-5 h-5 mr-2 text-indigo-500 dark:text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path></svg>
                                    Website or Portfolio
                                </span>
                            </label>
                            <input type="url"
                                   id="website"
                                   name="website"
                                   value="{{ user.website if user and user.website else '' }}"
                                   class="block w-full bg-white/80 dark:bg-gray-900/80 border border-gray-200/50 dark:border-indigo-900/50 rounded-xl px-5 py-4 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-400/50 focus:border-indigo-400 shadow-md hover:shadow-lg transition-all duration-300 ease-out text-base"
                                   placeholder="e.g., https://yourportfolio.com">
                        </div>
                    </div>
                </fieldset>

                <!-- Submit Button -->
                <div class="pt-8 text-center">
                    <button type="submit"
                            class="inline-flex items-center justify-center px-10 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white text-base font-semibold rounded-xl shadow-lg hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-indigo-400/50 transform hover:scale-105 active:scale-95 transition-all duration-300 ease-out group">
                        <svg class="w-5 h-5 mr-2 -ml-1 opacity-80 group-hover:opacity-100 transition-opacity" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                        Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}